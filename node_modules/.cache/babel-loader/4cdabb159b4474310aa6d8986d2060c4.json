{"ast":null,"code":"import _regeneratorRuntime from \"/Users/sarasimon/Desktop/projects/serverless-stack/grat-client/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/sarasimon/Desktop/projects/serverless-stack/grat-client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/Users/sarasimon/Desktop/projects/serverless-stack/grat-client/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/Users/sarasimon/Desktop/projects/serverless-stack/grat-client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/sarasimon/Desktop/projects/serverless-stack/grat-client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/sarasimon/Desktop/projects/serverless-stack/grat-client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/sarasimon/Desktop/projects/serverless-stack/grat-client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/sarasimon/Desktop/projects/serverless-stack/grat-client/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/sarasimon/Desktop/projects/serverless-stack/grat-client/src/containers/Notes.js\";\nimport React, { Component } from \"react\";\nimport { API, Storage } from \"aws-amplify\";\nimport { FormGroup, FormControl, ControlLabel, ListGroup, ListGroupItem } from \"react-bootstrap\";\nimport LoaderButton from \"../components/LoaderButton\";\nimport config from \"../config\";\nimport { s3Upload } from \"../libs/awsLib\";\nimport Moment from \"react-moment\";\nimport \"./Notes.css\";\n\nvar Notes =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Notes, _Component);\n\n  function Notes(props) {\n    var _this;\n\n    _classCallCheck(this, Notes);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Notes).call(this, props));\n\n    _this.handleChange = function (event) {\n      _this.setState(_defineProperty({}, event.target.id, event.target.value));\n    };\n\n    _this.handleFileChange = function (event) {\n      _this.file = event.target.files[0];\n    };\n\n    _this.handleSubmit =\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(event) {\n        var attachment;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                event.preventDefault();\n\n                if (!(_this.file && _this.file.size > config.MAX_ATTACHMENT_SIZE)) {\n                  _context.next = 4;\n                  break;\n                }\n\n                alert(\"Please pick a file smaller than \".concat(config.MAX_ATTACHMENT_SIZE / 1000000, \" MB.\"));\n                return _context.abrupt(\"return\");\n\n              case 4:\n                _this.setState({\n                  isLoading: true\n                });\n\n                _context.prev = 5;\n\n                if (!_this.file) {\n                  _context.next = 10;\n                  break;\n                }\n\n                _context.next = 9;\n                return s3Upload(_this.file);\n\n              case 9:\n                attachment = _context.sent;\n\n              case 10:\n                _context.next = 12;\n                return _this.saveNote({\n                  inputOne: _this.state.inputOne,\n                  inputTwo: _this.state.inputTwo,\n                  inputThree: _this.state.inputThree,\n                  attachment: attachment || _this.state.note.attachment\n                });\n\n              case 12:\n                _this.props.history.push(\"/\");\n\n                _context.next = 19;\n                break;\n\n              case 15:\n                _context.prev = 15;\n                _context.t0 = _context[\"catch\"](5);\n                alert(_context.t0);\n\n                _this.setState({\n                  isLoading: false\n                });\n\n              case 19:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[5, 15]]);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.handleDelete =\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(event) {\n        var confirmed;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                event.preventDefault();\n                confirmed = window.confirm(\"are you sure you want to delete this note?\");\n\n                if (confirmed) {\n                  _context2.next = 4;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\");\n\n              case 4:\n                _this.setState({\n                  isDeleting: true\n                });\n\n                _context2.prev = 5;\n                _context2.next = 8;\n                return _this.deleteNote();\n\n              case 8:\n                _this.props.history.push(\"/\");\n\n                _context2.next = 15;\n                break;\n\n              case 11:\n                _context2.prev = 11;\n                _context2.t0 = _context2[\"catch\"](5);\n                alert(_context2.t0);\n\n                _this.setState({\n                  isDeleting: false\n                });\n\n              case 15:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[5, 11]]);\n      }));\n\n      return function (_x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    _this.file = null;\n    _this.state = {\n      isLoading: null,\n      isDeleting: null,\n      note: null,\n      inputOne: \"\",\n      inputTwo: \"\",\n      inputThree: \"\",\n      createdDate: \"\",\n      attachmentURL: null\n    };\n    return _this;\n  }\n\n  _createClass(Notes, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3() {\n        var attachmentURL, note, createdDate, inputOne, inputTwo, inputThree, attachment;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.prev = 0;\n                _context3.next = 3;\n                return this.getNote();\n\n              case 3:\n                note = _context3.sent;\n                createdDate = new Date(note.createdAt).toLocaleString();\n                inputOne = note.inputOne, inputTwo = note.inputTwo, inputThree = note.inputThree, attachment = note.attachment;\n\n                if (!attachment) {\n                  _context3.next = 10;\n                  break;\n                }\n\n                _context3.next = 9;\n                return Storage.vault.get(attachment);\n\n              case 9:\n                attachmentURL = _context3.sent;\n\n              case 10:\n                this.setState({\n                  note: note,\n                  inputOne: inputOne,\n                  inputTwo: inputTwo,\n                  inputThree: inputThree,\n                  createdDate: createdDate,\n                  attachmentURL: attachmentURL\n                });\n                _context3.next = 16;\n                break;\n\n              case 13:\n                _context3.prev = 13;\n                _context3.t0 = _context3[\"catch\"](0);\n                alert(_context3.t0);\n\n              case 16:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this, [[0, 13]]);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"getNote\",\n    value: function getNote() {\n      return API.get(\"notes\", \"/notes/\".concat(this.props.match.params.id));\n    }\n  }, {\n    key: \"validateForm\",\n    value: function validateForm() {\n      return this.state.inputOne.length > 0 && this.state.inputTwo.length > 0 && this.state.inputThree.length > 0;\n    }\n  }, {\n    key: \"formatFilename\",\n    value: function formatFilename(str) {\n      return str.replace(/^\\w+-/, \"\");\n    }\n  }, {\n    key: \"saveNote\",\n    value: function saveNote(note) {\n      return API.put(\"notes\", \"/notes/$(this.props.match.params.id)\", {\n        body: note\n      });\n    }\n  }, {\n    key: \"deleteNote\",\n    value: function deleteNote() {\n      return API.del(\"notes\", \"/notes/$(this.props.match.params.id)\");\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        className: \"Notes\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }, this.state.note && React.createElement(\"form\", {\n        onSubmit: this.handleSubmit,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144\n        },\n        __self: this\n      }, React.createElement(ListGroup, {\n        varient: \"flush\",\n        controlId: \"viewNote\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145\n        },\n        __self: this\n      }, React.createElement(\"h5\", {\n        className: \"viewNoteHeader\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146\n        },\n        __self: this\n      }, React.createElement(Moment, {\n        format: \"MMMM Do YYYY\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147\n        },\n        __self: this\n      }, this.state.createdDate), \":\"), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150\n        },\n        __self: this\n      }, \"on this day, I was grateful for...\"), React.createElement(ListGroupItem, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151\n        },\n        __self: this\n      }, \"- \", this.state.inputOne), React.createElement(ListGroupItem, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152\n        },\n        __self: this\n      }, \"- \", this.state.inputTwo), React.createElement(ListGroupItem, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }, \"- \", this.state.inputThree)), this.state.note.attachment && React.createElement(FormGroup, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156\n        },\n        __self: this\n      }, React.createElement(ControlLabel, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        },\n        __self: this\n      }, \"attachment\"), React.createElement(FormControl.Static, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158\n        },\n        __self: this\n      }, React.createElement(\"a\", {\n        target: \"_blank\",\n        rel: \"noopener noreferrer\",\n        href: this.state.attachmentURL,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159\n        },\n        __self: this\n      }, this.formatFilename(this.state.note.attachment)))), React.createElement(LoaderButton, {\n        block: true,\n        bsStyle: \"primary\",\n        bsSize: \"large\",\n        disabled: !this.validateForm(),\n        type: \"submit\",\n        isLoading: this.state.isLoading,\n        text: \"save\",\n        loadingText: \"saving...\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168\n        },\n        __self: this\n      }), React.createElement(LoaderButton, {\n        block: true,\n        bsStyle: \"danger\",\n        bsSize: \"large\",\n        isLoading: this.state.isDeleting,\n        onClick: this.handleDelete,\n        text: \"delete\",\n        loadingText: \"deleting...\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return Notes;\n}(Component);\n\nexport { Notes as default };","map":{"version":3,"sources":["/Users/sarasimon/Desktop/projects/serverless-stack/grat-client/src/containers/Notes.js"],"names":["React","Component","API","Storage","FormGroup","FormControl","ControlLabel","ListGroup","ListGroupItem","LoaderButton","config","s3Upload","Moment","Notes","props","handleChange","event","setState","target","id","value","handleFileChange","file","files","handleSubmit","preventDefault","size","MAX_ATTACHMENT_SIZE","alert","isLoading","attachment","saveNote","inputOne","state","inputTwo","inputThree","note","history","push","handleDelete","confirmed","window","confirm","isDeleting","deleteNote","createdDate","attachmentURL","getNote","Date","createdAt","toLocaleString","vault","get","match","params","length","str","replace","put","body","del","formatFilename","validateForm"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { API, Storage } from \"aws-amplify\";\nimport { FormGroup, FormControl, ControlLabel, ListGroup, ListGroupItem } from \"react-bootstrap\";\nimport LoaderButton from \"../components/LoaderButton\";\nimport config from \"../config\";\nimport { s3Upload } from \"../libs/awsLib\";\nimport Moment from \"react-moment\";\nimport \"./Notes.css\";\n\nexport default class Notes extends Component {\n  constructor(props) {\n    super(props);\n\n    this.file = null;\n\n    this.state = {\n      isLoading: null,\n      isDeleting: null,\n      note: null,\n      inputOne: \"\",\n      inputTwo: \"\",\n      inputThree: \"\",\n      createdDate: \"\",\n      attachmentURL: null\n    };\n  }\n\n  async componentDidMount() {\n    try {\n      let attachmentURL;\n      const note = await this.getNote();\n      const createdDate = new Date(note.createdAt).toLocaleString();\n      const { inputOne, inputTwo, inputThree, attachment } = note;\n\n      if (attachment) {\n        attachmentURL =  await Storage.vault.get(attachment);\n      }\n\n      this.setState({\n        note,\n        inputOne,\n        inputTwo,\n        inputThree,\n        createdDate,\n        attachmentURL\n      });\n    } catch (e) {\n      alert(e);\n    }\n  }\n\n  getNote() {\n    return API.get(\"notes\", `/notes/${this.props.match.params.id}`);\n  }\n\n  validateForm() {\n    return (\n      this.state.inputOne.length > 0 &&\n      this.state.inputTwo.length > 0 &&\n      this.state.inputThree.length > 0\n    );\n  }\n\n  formatFilename(str) {\n    return str.replace(/^\\w+-/, \"\");\n  }\n\n  handleChange = event => {\n    this.setState({\n      [event.target.id]: event.target.value\n    });\n  }\n\n  handleFileChange = event => {\n    this.file = event.target.files[0];\n  }\n\n  saveNote(note) {\n    return API.put(\"notes\", `/notes/$(this.props.match.params.id)`, {\n      body: note\n    });\n  }\n\n  handleSubmit = async event => {\n    let attachment;\n\n    event.preventDefault();\n\n    if (this.file && this.file.size > config.MAX_ATTACHMENT_SIZE) {\n      alert(`Please pick a file smaller than ${config.MAX_ATTACHMENT_SIZE/1000000} MB.`);\n      return;\n    }\n\n    this.setState({ isLoading: true });\n\n    try {\n      if (this.file) {\n        attachment = await s3Upload(this.file);\n      }\n\n      await this.saveNote({\n        inputOne: this.state.inputOne,\n        inputTwo: this.state.inputTwo,\n        inputThree: this.state.inputThree,\n        attachment: attachment || this.state.note.attachment\n      });\n      this.props.history.push(\"/\");\n    } catch (e) {\n      alert(e);\n      this.setState({ isLoading: false });\n    }\n  }\n\n  deleteNote() {\n    return API.del(\"notes\", `/notes/$(this.props.match.params.id)`);\n  }\n\n  handleDelete = async event => {\n    event.preventDefault();\n\n    const confirmed = window.confirm(\n      \"are you sure you want to delete this note?\"\n    );\n\n    if (!confirmed) {\n      return;\n    }\n\n    this.setState({ isDeleting: true });\n\n    try {\n      await this.deleteNote();\n      this.props.history.push(\"/\");\n    } catch (e) {\n      alert(e);\n      this.setState({ isDeleting: false });\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"Notes\">\n        {this.state.note &&\n        <form onSubmit={this.handleSubmit}>\n          <ListGroup varient=\"flush\" controlId=\"viewNote\">\n            <h5 className=\"viewNoteHeader\">\n              <Moment format=\"MMMM Do YYYY\">\n                {this.state.createdDate}\n                </Moment>:</h5>\n            <p>on this day, I was grateful for...</p>\n            <ListGroupItem>- {this.state.inputOne}</ListGroupItem>\n            <ListGroupItem>- {this.state.inputTwo}</ListGroupItem>\n            <ListGroupItem>- {this.state.inputThree}</ListGroupItem>\n          </ListGroup>\n          {this.state.note.attachment &&\n          <FormGroup>\n            <ControlLabel>attachment</ControlLabel>\n            <FormControl.Static>\n              <a\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                href={this.state.attachmentURL}\n              >\n                {this.formatFilename(this.state.note.attachment)}\n              </a>\n            </FormControl.Static>\n          </FormGroup>}\n          <LoaderButton\n            block\n            bsStyle=\"primary\"\n            bsSize=\"large\"\n            disabled={!this.validateForm()}\n            type=\"submit\"\n            isLoading={this.state.isLoading}\n            text=\"save\"\n            loadingText=\"saving...\"\n          />\n          <LoaderButton\n            block\n            bsStyle=\"danger\"\n            bsSize=\"large\"\n            isLoading={this.state.isDeleting}\n            onClick={this.handleDelete}\n            text=\"delete\"\n            loadingText=\"deleting...\"\n          />\n        </form>}\n      </div>\n    );\n  }\n}"]},"metadata":{},"sourceType":"module"}